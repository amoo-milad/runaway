{% extends "critic/base.html" %}
{% load static %}
{% load critic_extras %}


{% block title %} All Reviews {% endblock title %}

{% block style %}
    <link rel="stylesheet" type="text/css" href="{% static 'critic/reviews.css' %}">
{% endblock style %}

{% block content %}

<h3 class="headshot">Reviews</h3>

<div class="separator">OF ALL TIMES</div>


<script>
    fetch('/movie/{}/rate/{}', {
        method: 'POST',
        headers: {
          'Accept': 'application/json',
          'Content-Type': 'application/json'
        },
        body: JSON.stringify(opts)
     })
    .then(function (response) {  
        console.log('Request success: ', response);
        return response.json();
    })  
    .catch(function (error) {  
        console.log('Request failure: ', error);  
    });


</script>



<table>
    <tr>
        <th>Title | Year</th>
        <th>Critic</th>
        <th>Stars</th>
        <th>Review</th>
    </tr>


{% if all_review_list %}
    {% for review in all_review_list %}
        <tr>
            <td><a href="{% url 'critic:review' review.id %}">{{ review.movie.title }}</a> ({{review.movie.year}})</td>

            <td><a href="{% url 'critic:author' review.author.id %}">{{ review.author }}</a></td>

            <td>
                <div class="stars2">
                    <div class="rating2">
                        <span>{% for star in review.id|get_stars %}â˜…{% endfor %}</span>
                    </div>
                </div>
            </td>

            <td>{{ review.review_text|truncatewords:30 }} 
            <br><a href="{% url 'critic:review' review.id %}">Read More</a> | Posted {{review.pub_date}}</td>

        </tr>
    {% endfor %}
{% else %}
    <h3> no 'all_review_list' found! </h3>
{% endif %}

</table>

{% if error_message %}<p><strong>{{ error_message }}</strong></p>{% endif %}


{% endblock content %}
